<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Page Template</title>
        <style type="text/css">
            
        </style>
        <script type="text/javascript" src="d3/d3-master/d3.js"></script>
    </head>
    <body>

        <!--Assignment 2A-->

        <svg width="280" height="140">
            <rect x="0" y="60" width="80" height="80" fill="purple" opacity="1" stroke="gray" stroke-width="2"></rect> 
            <rect x="50" y="45" width="80" height="80" fill="blue" opacity="0.8" stroke="gray" stroke-width="2"></rect>
            <rect x="100" y="30" width="80" height="80" fill="green" opacity="0.6" stroke="gray" stroke-width="2"></rect>
            <rect x="150" y="15" width="80" height="80" fill="yellow" opacity="0.4" stroke="gray" stroke-width="2"></rect>
            <rect x="200" y="0" width="80" height="80" fill="red" opacity="0.2" stroke="gray" stroke-width="2"></rect>
        </svg>
        <br>

        <!--Assignment 2B-->

        <p>Click on this text to toggle between 2003 and 2015!</p>
        <script type="text/javascript">

            //Width and height
            var w = 500;
            var h = 300;
            var padding = 30;
            
            var dataset = [['BAYVIEW',2121,11],
                            ['CENTRAL',1193,70],
                            ['INGLESIDE',2319,5],
                            ['MISSION',2063,713],
                            ['NORTHERN',1879,581],
                            ['PARK',1207,2],
                            ['RICHMOND',1081,15],
                            ['SOUTHERN',1426,18],
                            ['TARAVAL',1665,10],
                            ['TENDERLOIN',371,527]];                                        

            //Create scale functions
            var xScale = d3.scale.linear()
                                 .domain([0, d3.max(dataset, function(d) { return d[2]; })])
                                 .range([padding, w - padding * 2]);

            var yScale = d3.scale.linear()
                                 .domain([0, d3.max(dataset, function(d) { return d[1]; })])
                                 .range([h - padding, padding]);

            var rScale = d3.scale.linear()
                     .domain([0, d3.max(dataset, function(d) { return d[1]; })+d3.max(dataset, function(d) { return d[2]; })])
                     .range([2, 5]);

            //Define X axis
            var xAxis = d3.svg.axis()
                              .scale(xScale)
                              .orient("bottom")
                              .ticks(5);

            //Define Y axis
            var yAxis = d3.svg.axis()
                              .scale(yScale)
                              .orient("left")
                              .ticks(5);

            //Create SVG element
            var svg = d3.select("body")
                        .append("svg")
                        .attr("width", w)
                        .attr("height", h);

            //Create circles
            svg.selectAll("circle")
               .data(dataset)
               .enter()
               .append("circle")
               .attr("cx", function(d) {
                    return xScale(d[2]);
               })
               .attr("cy", function(d) {
                    return yScale(d[1]);
               })
               .attr("r", function(d) {
                        return rScale(d[2]+d[1]);
                    });

            //Add labels   
            svg.selectAll("text")
                       .data(dataset)
                       .enter()
                       .append("text")
                       .text(function(d) {
                            return d[0];
                       })
                       .attr("x", function(d) {
                            return xScale(d[2]);
                       })
                       .attr("y", function(d) {
                            return yScale(d[1]);
                       })
                       .attr("font-family", "sans-serif")
                       .attr("font-size", "11px")
                       .attr("fill", "red");
            
            //Create X axis
            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + (h - padding) + ")")
                .call(xAxis);
            
            //Create Y axis
            svg.append("g")
                .attr("class", "y axis")
                .attr("transform", "translate(" + padding + ",0)")
                .call(yAxis);



            //On click, update with new data            
            d3.select("p")
                .on("click", function() {

                    if (dataset==[['BAYVIEW',2121,11],
                                    ['CENTRAL',1193,70],
                                    ['INGLESIDE',2319,5],
                                    ['MISSION',2063,713],
                                    ['NORTHERN',1879,581],
                                    ['PARK',1207,2],
                                    ['RICHMOND',1081,15],
                                    ['SOUTHERN',1426,18],
                                    ['TARAVAL',1665,10],
                                    ['TENDERLOIN',371,527]];) {

                        var dataset = [['BAYVIEW',981,6]
                                        ['CENTRAL',549,44],
                                        ['INGLESIDE',1368,4],
                                        ['MISSION',1195,66],
                                        ['NORTHERN',943,42],
                                        ['PARK',639,1],
                                        ['RICHMOND',561,9],
                                        ['SOUTHERN',794,96],
                                        ['TARAVAL',786,78],
                                        ['TENDERLOIN',112,23]
                                        ]; 
                        
                        //Update scale domains
                        xScale.domain([0, d3.max(dataset, function(d) { return d[2]; })]);
                        yScale.domain([0, d3.max(dataset, function(d) { return d[1]; })]);

                        //Update all circles
                        svg.selectAll("circle")
                           .data(dataset)
                           .transition()
                           .duration(1000)      
                           .attr("cx", function(d) {
                                return xScale(d[2]);
                           })
                           .attr("cy", function(d) {
                                return yScale(d[1]);
                           });

                        //Add labels   
                        svg.selectAll("text")
                                   .data(dataset)
                                   .enter()
                                   .append("text")
                                   .text(function(d) {
                                        return d[0];
                                   })
                                   .attr("x", function(d) {
                                        return xScale(d[2]);
                                   })
                                   .attr("y", function(d) {
                                        return yScale(d[1]);
                                   })
                                   .attr("font-family", "sans-serif")
                                   .attr("font-size", "11px")
                                   .attr("fill", "red");

                        //Update X axis
                        svg.select(".x.axis")
                            .transition()
                            .duration(1000)
                            .call(xAxis);
                        
                        //Update Y axis
                        svg.select(".y.axis")
                            .transition()
                            .duration(1000)
                            .call(yAxis);
                }
                else {

                    var dataset = [['BAYVIEW',2121,11],
                            ['CENTRAL',1193,70],
                            ['INGLESIDE',2319,5],
                            ['MISSION',2063,713],
                            ['NORTHERN',1879,581],
                            ['PARK',1207,2],
                            ['RICHMOND',1081,15],
                            ['SOUTHERN',1426,18],
                            ['TARAVAL',1665,10],
                            ['TENDERLOIN',371,527]];                                         

            //Create scale functions
            var xScale = d3.scale.linear()
                                 .domain([0, d3.max(dataset, function(d) { return d[2]; })])
                                 .range([padding, w - padding * 2]);

            var yScale = d3.scale.linear()
                                 .domain([0, d3.max(dataset, function(d) { return d[1]; })])
                                 .range([h - padding, padding]);

            var rScale = d3.scale.linear()
                     .domain([0, d3.max(dataset, function(d) { return d[1]; })+d3.max(dataset, function(d) { return d[2]; })])
                     .range([2, 5]);

            //Define X axis
            var xAxis = d3.svg.axis()
                              .scale(xScale)
                              .orient("bottom")
                              .ticks(5);

            //Define Y axis
            var yAxis = d3.svg.axis()
                              .scale(yScale)
                              .orient("left")
                              .ticks(5);

            //Create SVG element
            var svg = d3.select("body")
                        .append("svg")
                        .attr("width", w)
                        .attr("height", h);

            //Create circles
            svg.selectAll("circle")
               .data(dataset)
               .enter()
               .append("circle")
               .attr("cx", function(d) {
                    return xScale(d[2]);
               })
               .attr("cy", function(d) {
                    return yScale(d[1]);
               })
               .attr("r", function(d) {
                        return rScale(d[2]+d[1]);
                    });

            //Add labels   
            svg.selectAll("text")
                       .data(dataset)
                       .enter()
                       .append("text")
                       .text(function(d) {
                            return d[0];
                       })
                       .attr("x", function(d) {
                            return xScale(d[2]);
                       })
                       .attr("y", function(d) {
                            return yScale(d[1]);
                       })
                       .attr("font-family", "sans-serif")
                       .attr("font-size", "11px")
                       .attr("fill", "red");
            
            //Create X axis
            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + (h - padding) + ")")
                .call(xAxis);
            
            //Create Y axis
            svg.append("g")
                .attr("class", "y axis")
                .attr("transform", "translate(" + padding + ",0)")
                .call(yAxis);

                    }
            });
        </script>
        <br>

        <!--Assignment 2C-->
        <p>Click on this text to toggle between crimes of prostitution and vehicle theft in 2003!</p>

        <script>

        var dataset1=[5,10,18,22];
            //Width and height
            var w = 500;
            var h = 300;
            var barPadding = 1;
            //Create SVG element
            var svg1 = d3.select("body")
                        .append("svg")
                        .attr("width", w)
                        .attr("height", h);
            svg1.selectAll("rect")
                       .data(dataset1)
                       .enter()
                       .append("rect")
                       .attr({
                            x: function(d, i) { return i * (w / dataset1.length); },
                            y: function(d) { return h - (d * 4); },
                            width: w / dataset1.length - barPadding,
                            height: function(d) { return d * 4; },
                            fill: function(d) { return "rgb(0, 0, " + (d * 10) + ")"; }
                       });
            svg1.selectAll("text")
                       .data(dataset1)
                       .enter()
                       .append("text")
                       .text(function(d) {
                            return d;
                       })
                       .attr("text-anchor", "middle")
                       .attr("x", function(d, i) {
                            return i * (w / dataset1.length) + (w / dataset1.length - barPadding) / 2;
                        })
                       .attr("y", function(d) {
                            return h - (d * 4)+14;
                       })
                       .attr("font-family", "sans-serif")
                       .attr("font-size", "11px")
                       .attr("fill", "white");

        </script>

    </body>
</html>